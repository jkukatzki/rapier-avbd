1. **Capture the AVBD mathematical foundation to inform the modeling phase**, focusing on the augmented Lagrangian dual step, stiffness escalation, and stability claims that differentiate AVBD from classical VBD/PGS approaches.​:codex-file-citation[codex-file-citation]{line_range_start=11 line_range_end=104 path=llm_digests/avbd_paper_pdf_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_paper_pdf_digest.txt#L11-L104"}​ :::task-stub{title="Digest AVBD formulation and stability rationale"} - Re-read `llm_digests/avbd_paper_pdf_digest.txt` lines 11-104 and extract the core equations driving primal updates, dual augmentation, and stiffness growth. - Summarize how these mechanics enable hard-constraint handling and rapid convergence for stacked rigid bodies. - Translate the findings into a concise internal math brief to guide subsequent modeling work. ::: 2. **Document per-body solve equations and warm-start parameters (α, β, γ) that will anchor the concrete mathematical model.**​:codex-file-citation[codex-file-citation]{line_range_start=18 line_range_end=83 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L18-L83"}​ :::task-stub{title="Record update equations and solver parameters"} - From `llm_digests/gpt5_discussion_digest.txt` lines 18-83, capture the exact forms of \(H_i \Delta x_i = f_i\), pose updates, and the augmented Lagrangian parameter schedule. - Produce reference notes detailing recommended defaults (α=0.95, β=10, γ=0.99) and their intended effects on convergence. - Store these notes with citations for use when writing the math modeling documentation and code comments. ::: 3. **Catalog constraint energy types and implementation cues from Houdini and the AVBD 2D demo to guide 3D constraint modeling.**​:codex-file-citation[codex-file-citation]{line_range_start=179 line_range_end=198 path=llm_digests/avbd_houdini_impl_git_repo_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_houdini_impl_git_repo_digest.txt#L179-L198"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=70 path=llm_digests/avbd_2d_demo_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_2d_demo_digest.txt#L1-L70"}​ :::task-stub{title="Assemble cross-reference of existing AVBD constraint patterns"} - Review `llm_digests/avbd_houdini_impl_git_repo_digest.txt` lines 179-198 for energy formulations and DOF handling. - Extract relevant constraint structures from `llm_digests/avbd_2d_demo_digest.txt` lines 1-70 (springs, joints, solver shell). - Build a mapping of constraint types (contacts, joints, springs) to the data and math they require in 3D Rapier. ::: 4. **Identify shortcomings from the previous attempt—heavy scratch work, serial warm-starting, naive bindings—to avoid repeating the same pitfalls.**​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=30 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L1-L30"}​ :::task-stub{title="Compile lessons learned from first AVBD prototype"} - Read `llm_digests/first_attempt_caveats_digest.txt` lines 1-30 and list each performance or architecture problem encountered. - Tag each item with impacted modules (solver workspace, constraint wrappers, warm-start logic). - Share the summary with the team as a checklist of anti-patterns to eliminate in the redesign. ::: 5. **Revise ROADMAP.md so phase sequencing starts with formal math modeling, then moves into workspace/pooling design while embedding the first-attempt caveats.**​:codex-file-citation[codex-file-citation]{line_range_start=20 line_range_end=30 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L20-L30"}​ :::task-stub{title="Reorder and expand ROADMAP.md with new priorities"} - Update `ROADMAP.md` to start with concrete mathematical modeling tasks before implementation. - Integrate lessons from `first_attempt_caveats_digest.txt` lines 20-30 as explicit action items in the roadmap phases. - Ensure subsequent phases cover workspace staging, pooling, and determinism checkpoints before advanced features. ::: 6. **Design the SolverWorkspace refactor so body state is staged per island, enabling deterministic parallel bucket updates.**​:codex-file-citation[codex-file-citation]{line_range_start=16 line_range_end=30 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L16-L30"}​ :::task-stub{title="Plan staged workspace architecture"} - Draft a technical design for a staged `SolverWorkspace` holding per-body pose/velocity buffers and constraint-local caches. - Define synchronization points where staged data flushes back to `RigidBodySet`. - Outline API changes for constraints to operate on staged views rather than live bodies. ::: 7. **Plan the color bucket strategy, informed by Houdini’s graph coloring guidance, to split constraint sets for parallel execution.**​:codex-file-citation[codex-file-citation]{line_range_start=145 line_range_end=166 path=llm_digests/avbd_houdini_impl_git_repo_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_houdini_impl_git_repo_digest.txt#L145-L166"}​ :::task-stub{title="Blueprint deterministic color bucket scheduling"} - Study `llm_digests/avbd_houdini_impl_git_repo_digest.txt` lines 145-166 for graph coloring usage. - Determine how Rapier’s constraint graph can reuse or adapt similar coloring to isolate buckets. - Specify how bucket metadata will be stored alongside staged workspace entries for thread-safe iteration. ::: 8. **Outline the augmented Lagrangian update loop, making sure stiffness escalation and dual updates are pooled efficiently.**​:codex-file-citation[codex-file-citation]{line_range_start=70 line_range_end=123 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L70-L123"}​ :::task-stub{title="Detail AL update sequencing and pooling needs"} - From `gpt5_discussion_digest.txt` lines 70-123, sequence the dual ascent, stiffness growth, and warm-start steps. - Decide where pooled constraint objects hold λ and k values between frames. - Note any additional data (tolerances, clamps) required for deterministic behavior. ::: 9. **Specify the nalgebra-based linear algebra primitives for the 6×6 rigid-body solves and constraint projections.**​:codex-file-citation[codex-file-citation]{line_range_start=20 line_range_end=67 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L20-L67"}​ :::task-stub{title="Select nalgebra structures for body updates"} - Map each matrix/vector in the equations (Hᵢ, fᵢ, Δxᵢ) to nalgebra types (e.g., `Matrix6`, `Vector6`). - Record decomposition choices (Cholesky/LDLT) aligned with nalgebra capabilities. - Incorporate these decisions into the math modeling deliverables for implementation clarity. ::: 10. **Plan the feature-flagged build configuration so AVBD can replace PGS entirely when the flag is enabled.**​:codex-file-citation[codex-file-citation]{line_range_start=25 line_range_end=37 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L25-L37"}​ :::task-stub{title="Define Cargo feature gating for solver swap"} - Enumerate Cargo feature names and dependencies required to compile Rapier with AVBD and without the legacy solver. - Identify affected modules (`src/dynamics/solver/*`, build scripts) and annotate expected cfg guards. - Draft acceptance criteria ensuring mutually exclusive solver builds. ::: 11. **Align the Rust→WASM build pipeline with Rapier’s existing workflow while injecting the AVBD feature toggle.**​:codex-file-citation[codex-file-citation]{line_range_start=25 line_range_end=37 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L25-L37"}​ :::task-stub{title="Integrate AVBD feature into wasm-pack pipeline"} - Review current build scripts in `rapier-wasm-avbd` and determine insertion points for the new feature flag. - Document command invocations (e.g., `wasm-pack build --features avbd_solver`) matching the standard Rapier pipeline. - Ensure CI or scripted builds can switch between official and local packages seamlessly. ::: 12. **Design the HTML Three.js demo that can toggle between upstream Rapier and the local AVBD build without API changes.**​:codex-file-citation[codex-file-citation]{line_range_start=10 line_range_end=13 path=AGENTS.md git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/AGENTS.md#L10-L13"}​ :::task-stub{title="Plan three.js + Rapier demo integration"} - Sketch an HTML template loading latest Three.js and Rapier modules, with comments to switch between npm and local wasm. - List sample scenarios (ground plane drop, stacked rigid bodies, joints) to instantiate for solver comparisons. - Determine data flow between Rapier physics updates and Three.js instanced meshes for visualization. ::: 13. **Define integration tests to verify AVBD scenes stay above the ground plane (y ≥ 0) and remain deterministic against impulse baselines.**​:codex-file-citation[codex-file-citation]{line_range_start=126 line_range_end=131 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L126-L131"}​ :::task-stub{title="Specify deterministic physics regression tests"} - Enumerate test scenes (e.g., falling cubes, joint chains) and expected invariants (no penetration below y=0). - Plan assertions comparing AVBD impulse responses and verifying deterministic outcomes across runs. - Document how to run these tests in both native and wasm contexts. ::: 14. **Add benchmarking checkpoints that track solver iteration counts and timing to measure progress toward parity with the impulse solver.**​:codex-file-citation[codex-file-citation]{line_range_start=13 line_range_end=21 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L13-L21"}​ :::task-stub{title="Design performance benchmarking protocol"} - Define metrics (time/step, iterations, memory churn) referencing prior slowdown data. - Identify representative benchmark scenes where the first attempt struggled. - Establish a reporting format to compare AVBD vs. legacy solver runs over time. ::: 15. **Plan memory pooling and allocation strategies to minimize per-constraint scratch work and reuse buffers.**​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=13 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L1-L13"}​ :::task-stub{title="Outline constraint workspace pooling strategy"} - Catalog the scratch data (gradients, Jacobians, Hessians) previously recomputed every iteration. - Determine pooling structures (arenas, freelists) to recycle these buffers. - Integrate pooling plans into the solver workspace design for efficient reuse. ::: 16. **Chart the redesign of constraint wrappers so they operate on staged body views and avoid repeated transformation work.**​:codex-file-citation[codex-file-citation]{line_range_start=7 line_range_end=27 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L7-L27"}​ :::task-stub{title="Refactor constraint interfaces around staged data"} - Specify new APIs for contacts/joints that receive staged poses and cached transforms. - Plan warm-start data caching per manifold or joint to eliminate repeated calculations. - Align wrapper responsibilities with workspace staging to maintain determinism. ::: 17. **Map out the deterministic parallel execution roadmap, including when to introduce Rayon and how to handle color bucket synchronization.**​:codex-file-citation[codex-file-citation]{line_range_start=16 line_range_end=28 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L16-L28"}​​:codex-file-citation[codex-file-citation]{line_range_start=145 line_range_end=193 path=llm_digests/avbd_houdini_impl_git_repo_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_houdini_impl_git_repo_digest.txt#L145-L193"}​ :::task-stub{title="Schedule parallelization milestones"} - Establish milestones: serial staging, per-bucket parallel updates, eventual Rayon integration. - Document synchronization requirements to keep updates deterministic despite parallelism. - Reference Houdini’s approach to merging dual solve logic once points are updated as inspiration. ::: 18. **Record future-facing WebGPU considerations once CPU parity is achieved, inspired by the paper’s GPU results.**​:codex-file-citation[codex-file-citation]{line_range_start=7 line_range_end=26 path=llm_digests/avbd_paper_pdf_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_paper_pdf_digest.txt#L7-L26"}​​:codex-file-citation[codex-file-citation]{line_range_start=134 line_range_end=136 path=llm_digests/gpt5_discussion_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/gpt5_discussion_digest.txt#L134-L136"}​ :::task-stub{title="Draft WebGPU follow-up research notes"} - Note the paper’s GPU performance metrics as motivation for later exploration. - Outline prerequisites (CPU staging, bucket parallelism) before a WebGPU prototype. - Collect references or potential APIs for compute shader implementations. ::: 19. **Document licensing and reference sources (TinyVBD, Gaia, Warp, AVBD-2D) that informed prior work, ensuring compliance and knowledge sharing.**​:codex-file-citation[codex-file-citation]{line_range_start=57 line_range_end=110 path=llm_digests/avbd_houdini_impl_git_repo_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_houdini_impl_git_repo_digest.txt#L57-L110"}​ :::task-stub{title="Assemble reference and licensing dossier"} - Extract cited repositories and their licenses from the Houdini digest. - Create an internal document tracking third-party inspirations and permissible code usage. - Share the dossier with stakeholders to avoid future legal ambiguity. ::: 20. **Consolidate all findings into a 20-step execution roadmap deliverable, ensuring each phase references the relevant digest materials for future consultation.**​:codex-file-citation[codex-file-citation]{line_range_start=11 line_range_end=104 path=llm_digests/avbd_paper_pdf_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/avbd_paper_pdf_digest.txt#L11-L104"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=30 path=llm_digests/first_attempt_caveats_digest.txt git_url="https://github.com/jkukatzki/rapier-avbd/blob/numba2/llm_digests/first_attempt_caveats_digest.txt#L1-L30"}​ :::task-stub{title="Publish the comprehensive project roadmap"} - Compile the steps above into a single project document for the team. - Embed citations back to the digest sources so engineers can quickly cross-reference detailed material. - Review the roadmap with stakeholders to confirm alignment on priorities and sequencing. ::: 